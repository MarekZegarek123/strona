<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skibidi bomba</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        h1 {
            color: #333;
        }

        .person {
            background-color: #f0f8ff;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
        }

        .no-one {
            color: red;
            font-weight: bold;
        }

        .form-link {
            margin-top: 20px;
            display: block;
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            text-align: center;
            text-decoration: none;
            border-radius: 5px;
            width: 200px;
        }

        .form-link:hover {
            background-color: #45a049;
        }
    </style>
</head>

<body>
    <h1>Skibidi sigma</h1>
    <div id="free-people"></div>

    <!-- Link do formularza -->
    <a href="add.html" class="form-link">Dodaj swoje wolne godziny</a>

    <script>
        let schedule = []; // Zmienna do przechowywania danych z pliku JSON

        // Funkcja do załadowania danych z pliku JSON
        async function loadSchedule() {
            const response = await fetch('dane.json'); // Upewnij się, że ścieżka do pliku JSON jest poprawna
            schedule = await response.json();
            checkFreePeople(); // Wywołujemy funkcję po załadowaniu danych
        }

        // Funkcja sprawdzająca, kto ma teraz wolny czas
        function checkFreePeople() {
            const now = new Date();
            const currentDay = now.getDay(); // Zwraca dzień tygodnia (0 = niedziela, 1 = poniedziałek, itd.)
            const currentTime = now.toTimeString().slice(0, 5); // Wyciąga aktualną godzinę w formacie HH:MM

            // Wyświetlamy osoby na stronie
            const freePeopleDiv = document.getElementById('free-people');
            freePeopleDiv.innerHTML = '';

            // Iterujemy przez osoby
            schedule.forEach(person => {
                const personDiv = document.createElement('div');
                personDiv.classList.add('person');

                // Sprawdzamy status osoby
                if (person.status === "available") {
                    personDiv.innerHTML = `${person.name} jest aktywny.`;
                } else if (person.status === "unavailable") {
                    // Filtrujemy harmonogram, aby znaleźć dostępne czasy
                    const availableTimes = person.schedule.filter(timeSlot =>
                        timeSlot.day === currentDay &&
                        currentTime >= timeSlot.start &&
                        currentTime <= timeSlot.end
                    );

                    // Wyświetlamy godziny, jeśli są dostępne
                    if (availableTimes.length > 0) {
                        availableTimes.forEach(timeSlot => {
                            personDiv.innerHTML += `${person.name} ma wolny czas do ${timeSlot.end}. `;
                        });
                    } else {
                        personDiv.innerHTML = `${person.name} nie ma wolnego czasu.`;
                    }
                }

                freePeopleDiv.appendChild(personDiv);
            });

            // Sprawdzenie, czy nie ma żadnej osoby z wolnym czasem
            if (freePeopleDiv.innerHTML === '') {
                const noOneDiv = document.createElement('div');
                noOneDiv.classList.add('no-one');
                noOneDiv.textContent = "Nikt nie ma czasu.";
                freePeopleDiv.appendChild(noOneDiv);
            }
        }

        // Ładujemy dane z pliku JSON przy załadowaniu strony
        window.onload = loadSchedule;
    </script>

</body>

</html>